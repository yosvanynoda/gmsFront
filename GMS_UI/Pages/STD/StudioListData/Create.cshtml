@page
@model GMS_UI.Pages.STD.StudioListData.CreateModel
@{
    ViewData["Title"] = "Create Studio";
}
<div class="wizard-container">
    <div class="row">
        <div class="col">
            <h2 class="text-center">
                <i class="fas fa-flask text-primary"></i>
                Create Study Research
            </h2>
        </div>
        <div class="col-3">
            <button type="submit" class="btn btn-outline-primary float-end" id="saveLaterBtn" style="margin-top: 0;">
                <i class="bi bi-bookmark-check-fill"></i> Save
            </button>
        </div>
    </div>
    

    <form asp-page-handler="Create" method="post" id="wizardForm" >

        <input type="hidden" id="blindingType" value="@Model.BlindingTypeSL" />
        <input type="hidden" id="phaseType" value="@Model.PhaseTypeSL" />
        <input type="hidden" id="randomizationType" value="@Model.RandomizationTypeSL" />
        <input type="hidden" id="studioStatus" value="@Model.StudioStatusSL" />

        <input type="hidden" id="studioID" value="@Model.Input.STDGeneralData.STDId" />

        @* <input type="hidden" id="sponsor" value="@Model.SponsorSL" />
        <input type="hidden" id="disease" value="@Model.DiseaseSL" />
        <input type="hidden" id="cro" value="@Model.CROSL" />
        <input type="hidden" id="documentType" value="@Model.DocumentTypeSL" />
        <input type="hidden" id="monitor" value="@Model.MonitorSL" /> *@

        <!-- Progress Indicator -->
        <div class="step-indicator">
            <div class="step-circle active" id="step1-indicator" onclick="goToStep(1)">1</div>
            <div class="step-line" id="line1"></div>
            <div class="step-circle" id="step2-indicator" onclick="goToStep(2)">2</div>
            <div class="step-line" id="line2"></div>
            <div class="step-circle" id="step3-indicator" onclick="goToStep(3)">3</div>
            <div class="step-line" id="line3"></div>
            <div class="step-circle" id="step4-indicator" onclick="goToStep(4)">4</div>
            <div class="step-line" id="line4"></div>
            <div class="step-circle" id="step5-indicator" onclick="goToStep(5)">5</div>
            <div class="step-line" id="line5"></div>
            <div class="step-circle" id="step6-indicator" onclick="goToStep(6)">6</div>
            <div class="step-line" id="line6"></div>
            <div class="step-circle" id="step7-indicator" onclick="goToStep(7)">7</div>
            <div class="step-line" id="line7"></div>
            <div class="step-circle" id="step8-indicator" onclick="goToStep(8)">8</div>
            <div class="step-line" id="line8"></div>
            <div class="step-circle" id="step9-indicator" onclick="goToStep(9)">9</div>
        </div>

        <!-- Step 1: Studio Data -->
        <div class="wizard-step active wizard-body" id="step1">
            <div class="form-section">
                <h5><i class="fa fa-info-circle"></i> Basic Study Information</h5>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Sponsor *</label>
                            <select id="sponsorList" class="form-select" required>
                                <option value="-1">Select Sponsor</option>
                            </select>
                            <span class="text-danger" id="validateSponsor"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.DateCreated">Date Created *</label>
                            <input type="date" class="form-control" asp-for="Input.STDGeneralData.DateCreated" placeholder="Date Created" required />
                            <span class="text-danger" id="validateStudyDateCreated"></span>
                        </div>
                    </div>
                    
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.Code">Code *</label> 
                            <input class="form-control" asp-for="Input.STDGeneralData.Code" placeholder="Code" required /> 
                            <span class="text-danger" id="validateStudyCode"></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.Name">Name *</label> 
                            <input class="form-control" asp-for="Input.STDGeneralData.Name" placeholder="Name" required />
                            <span class="text-danger" id="validateStudyName"></span>
                        </div>
                    </div>
                    
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.Description">Description</label>
                            <textarea class="form-control" asp-for="Input.STDGeneralData.Description" placeholder="Description"></textarea>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.Notes">Notes</label>
                            <textarea class="form-control" asp-for="Input.STDGeneralData.Notes" placeholder="Notes"></textarea>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Step 2 Other General Data...-->
        <div class="wizard-step wizard-body" id="step2">
            <div class="form-section">
                <h5><i class="fa fa-info-circle"></i> Goal and Other specifications</h5>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.Goal">Goal *</label>
                            <input type="number" class="form-control" asp-for="Input.STDGeneralData.Goal" placeholder="Goal" required />
                            <span class="text-danger" id="validateStudyGoal"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Phase *</label>
                            <select id="phaseList" class="form-select" required>
                                <option value="-1">Select Phase</option>
                            </select>
                            <span class="text-danger"></span> 
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.Indication">Indication *</label>
                            <input class="form-control" asp-for="Input.STDGeneralData.Indication" placeholder="Indication" required />
                            <span class="text-danger" id="validateStudyIndication"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.TherapeuticArea">Therapeutic Area *</label>
                            <input class="form-control" asp-for="Input.STDGeneralData.TherapeuticArea" placeholder="Therapeutic Area" required />
                            <span class="text-danger" id="validateStudyTherapeuticArea"></span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Bliding Type *</label> 
                            <select id="blidingList" class="form-select" required>
                                <option value="-1">Select Bliding Type</option>
                            </select>
                            <span class="text-danger" id=""></span> 
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Randomization Type *</label> 
                            <select id="randomizationList" class="form-select" required>
                                <option value="-1">Select Randomization Type</option>
                            </select>
                            <span class="text-danger"></span> 
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Step 3: Dates and Others -->
        <div class="wizard-step wizard-body" id="step3">
            <div class="form-section">
                <h5><i class="fa fa-cogs"></i> Study Design & Methodology</h5>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.StartDate">Start Date *</label> 
                            <input type="date" asp-for="Input.STDGeneralData.StartDate" class="form-control" required /> 
                            <span class="text-danger" id="startDateValidate"></span> 
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label" asp-for="Input.STDGeneralData.EndDate">End Date *</label>
                            <input type="date" class="form-control" asp-for="Input.STDGeneralData.EndDate" required />
                            <span class="text-danger" id="endDateValidate"></span> 
                        </div>
                    </div>
                </div>

                <div class="row">
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Study Status *</label> 
                            <select id="studystatusList" class="form-select" required>
                                <option value="-1">Select Study Status</option>
                            </select>
                            <span class="text-danger" id=""></span> 
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Disease *</label> <!--asp-for="StudyPhase"-->
                            <select id="diseaseList" class="form-select" required>
                                <!--asp-for="StudyPhase"-->
                                <option value="-1">Select Disease</option>
                            </select>
                            <span class="text-danger"></span> <!--asp-validation-for="StudyPhase"-->
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">CRO </label> <!--asp-for="StudyPhase"-->
                            <select id="croList" class="form-select" >
                                <!--asp-for="StudyPhase"-->
                                <option value="-1">Select CRO</option>
                            </select>
                            <span class="text-danger" id=""></span> <!--asp-validation-for="StudyPhase"-->
                        </div>
                    </div>
                </div>
                
            </div>
        </div>

        <!-- Step 4: Monitor -->
        <div class="wizard-step wizard-body" id="step4">
            <div class="form-section">
                <h5><i class="fas fa-shield-alt"></i> Monitors</h5>

                <div class="card shadow border rounded-3 bg-light" style="width:100%; height:40vh">
                    <div class="card-header headerReference">
                        <button data-bs-toggle="modal" data-bs-target="#monitorNewModal" class="btn btn-sm btn-success float-end buttonReference"><i class="bi bi-plus-circle"></i> Add</button>
                    </div>
                    <div class="card-body">
                        <div id="monitorGrid" style="height:100%; width: 100%;" class="ag-theme-balham"></div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Step 5: Documents -->
        <div class="wizard-step wizard-body" id="step5">
            <div class="form-section">
                <h5><i class="fas fa-shield-alt"></i> Regulatory & Ethics Information</h5>

                <div class="card shadow border rounded-3 bg-light" style="width:100%; height:40vh">
                    <div class="card-header headerReference">
                        <button data-bs-toggle="modal" data-bs-target="#documentNewModal" class="btn btn-sm btn-success float-end buttonReference"><i class="bi bi-plus-circle"></i> Add</button>
                    </div>
                    <div class="card-body">
                        <div id="documentGrid" style="height:100%; width: 100%;" class="ag-theme-balham"></div>
                    </div>
                </div>
                
            </div>
        </div>

        <!-- Step 6: Protocol -->
        <div class="wizard-step wizard-body" id="step6">
            <div class="form-section">
                <h5><i class="fas fa-check-circle"></i>Protocol</h5>

                <div class="card shadow border rounded-3 bg-light" style="width:100%; height:40vh">
                    <div class="card-header headerReference">
                        <button data-bs-toggle="modal" data-bs-target="#protocolNewModal" class="btn btn-sm btn-success float-end buttonReference"><i class="bi bi-plus-circle"></i> Add</button>
                    </div>
                    <div class="card-body">
                        <div id="protocolGrid" style="height:100%; width: 100%;" class="ag-theme-balham"></div>
                    </div>
                </div>
                
            </div>
        </div>

        <!-- Step 7: Arms -->
        <div class="wizard-step wizard-body" id="step7">
            <div class="form-section">
                <h5><i class="fas fa-check-circle"></i> Arms</h5>

                <div class="card shadow border rounded-3 bg-light" style="width:100%; height:40vh">
                    <div class="card-header headerReference">
                        <button data-bs-toggle="modal" data-bs-target="#armsNewModal" class="btn btn-sm btn-success float-end buttonReference"><i class="bi bi-plus-circle"></i> Add</button>
                    </div>
                    <div class="card-body">
                        <div id="armsGrid" style="height:100%; width: 100%;" class="ag-theme-balham"></div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Step 8: Visits -->
        <div class="wizard-step wizard-body" id="step8">
            <div class="form-section">
                <h5><i class="fas fa-check-circle"></i> Visits</h5>

                <div class="card shadow border rounded-3 bg-light" style="width:100%; height:40vh">
                    <div class="card-header headerReference">
                        <button data-bs-toggle="modal" data-bs-target="#visitsNewModal" class="btn btn-sm btn-success float-end buttonReference"><i class="bi bi-plus-circle"></i> Add</button>
                    </div>
                    <div class="card-body">
                        <div id="visitsGrid" style="height:100%; width: 100%;" class="ag-theme-balham"></div>
                    </div>
                </div>


            </div>
        </div>

        <!-- Step 9: Review and Confirm -->
        <div class="wizard-step wizard-body" id="step9">
            <div class="form-section">
                <h5><i class="fas fa-check-circle"></i> Review & Submit</h5>

                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    Please review all information before submitting. You can go back to previous steps to make changes.
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <h6>Study Summary</h6>
                        <div id="reviewSummary" class="p-3 bg-light rounded">
                            <!-- Summary will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                @* <div class="mt-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="confirmSubmission" required>
                        <label class="form-check-label" for="confirmSubmission">
                            I confirm that all information provided is accurate and complete
                        </label>
                    </div>
                </div> *@
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="wizard-navigation" >
            <button type="button" class="btn btn-secondary btn-wizard" id="prevBtn" onclick="changeStep(-1)" style="display: none;">
                <i class="fas fa-arrow-left"></i> Previous
            </button>
            <div class="ms-auto">
                <button type="button" class="btn btn-primary btn-wizard" id="nextBtn" onclick="changeStep(1)">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
                <button type="submit" class="btn btn-success btn-wizard" id="submitBtn" style="display: none;">
                    <i class="fas fa-check"></i> Submit Study
                </button>
            </div>
        </div>

    </form>
</div>

<script>
    window._csrfToken = $('@Html.AntiForgeryToken()').val();
    urlIndex = '/STD/StudioListData';
    urlIndexSponsor = '/STD/Sponsor';
    urlIndexReferenceData = '/CMN/ReferenceData';
    urlIndexMonitor = '/STD/Monitor';
</script>
<script src="/js/std/studioListData/studioCreate.js"></script>
